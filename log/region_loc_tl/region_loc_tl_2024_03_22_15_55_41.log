2024-03-22T15:55:41.533397+0545 - [Info]: ########################## Operations in DWH_REGION_LOC_LU Table ##########################
2024-03-22T15:55:41.534483+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:42.354596+0545 - [Info]: Snowflake has been connected successfully
2024-03-22T15:55:42.355383+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:42.355383+0545 - [Info]: Creating Temp Table: TEMP_REGION_LOC_LU
2024-03-22T15:55:42.358353+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:43.117353+0545 - [Info]: Query has been executed successfully: 
CREATE TABLE IF NOT EXISTS TEMP_REGION_LOC_LU(
                    LOC_ID INT,
                    REGION_ID INT
                    )
2024-03-22T15:55:43.118099+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:43.118099+0545 - [Info]: If table already exists then truncating temp table: TEMP_REGION_LOC_LU
2024-03-22T15:55:43.118099+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:43.394335+0545 - [Info]: Query has been executed successfully: TRUNCATE TEMP_REGION_LOC_LU
2024-03-22T15:55:43.395430+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:43.939399+0545 - [Info]: Query has been executed successfully: INSERT INTO TEMP_REGION_LOC_LU (select * from V_REGION_LOC)
2024-03-22T15:55:43.939399+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:43.940169+0545 - [Info]: Creating Target Table: DWH_REGION_LOC_LU
2024-03-22T15:55:43.940169+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:44.042587+0545 - [Info]: Query has been executed successfully: 
CREATE TABLE IF NOT EXISTS DWH_REGION_LOC_LU(
                    REGION_LOC_KEY INT,
                    LOC_ID INT,
                    REGION_ID INT,
                    REC_START_TS TIMESTAMP_LTZ,
                    REC_END_TS TIMESTAMP_LTZ,
                    REC_CLOSE_FLG BOOLEAN
                    )
2024-03-22T15:55:44.042587+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:44.043644+0545 - [Info]: Updating and Inserting Target Table: DWH_REGION_LOC_LU under SCD Type-1 Approach
2024-03-22T15:55:44.043644+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:44.827102+0545 - [Error]: Query could not be executed with error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [103, 1, 101, 1711094384793000000, 7258147199999999000, 0]
2024-03-22T15:55:44.827102+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:44.828106+0545 - [Info]: Closing Inactives of: DWH_REGION_LOC_LU under SCD Type-1 Approach
2024-03-22T15:55:44.828106+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:45.294977+0545 - [Info]: Query has been executed successfully: 
            UPDATE DWH_REGION_LOC_LU
            SET REC_CLOSE_FLG = TRUE,
            REC_END_TS = CURRENT_TIMESTAMP
            WHERE REGION_ID NOT IN
            (SELECT DISTINCT REGION_ID FROM TEMP_REGION_LOC_LU)
            
2024-03-22T15:55:45.294977+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:45.296024+0545 - [Info]: ETL of Table: DWH_REGION_LOC_LU  has been completed successfully!!!
2024-03-22T15:55:45.296024+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-03-22T15:55:45.443855+0545 - [Info]: Connection has been closed successfully
2024-03-22T15:55:45.444773+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
