2024-05-06T09:11:59.889991+0545 - [Info]: ########################## Operations in DWH_ORG_LOC_LU Table ##########################
2024-05-06T09:11:59.890918+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:01.018142+0545 - [Info]: Snowflake has been connected successfully
2024-05-06T09:12:01.018142+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:01.018868+0545 - [Info]: Creating Temp Table: TEMP_ORG_LOC_LU
2024-05-06T09:12:01.019870+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:01.147606+0545 - [Info]: Query has been executed successfully: 
CREATE TABLE IF NOT EXISTS TEMP_ORG_LOC_LU(
                    LOC_ID INT,
                    ORG_ID INT,
                    ORG_DESC VARCHAR(40),
                    ORG_IS_ACTIVE_FLG BOOLEAN
                    )
2024-05-06T09:12:01.148546+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:01.148546+0545 - [Info]: If table already exists then truncating temp table: TEMP_ORG_LOC_LU
2024-05-06T09:12:01.148546+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:01.490090+0545 - [Info]: Query has been executed successfully: TRUNCATE TEMP_ORG_LOC_LU
2024-05-06T09:12:01.491075+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.249130+0545 - [Info]: Query has been executed successfully: INSERT INTO TEMP_ORG_LOC_LU (select * from V_ORG_LOC)
2024-05-06T09:12:02.250129+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.250129+0545 - [Info]: Creating Target Table: DWH_ORG_LOC_LU
2024-05-06T09:12:02.251084+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.406849+0545 - [Info]: Query has been executed successfully: 
CREATE TABLE IF NOT EXISTS DWH_ORG_LOC_LU(
                    ORG_KEY INT,
                    LOC_ID INT,
                    ORG_ID INT,
                    ORG_DESC VARCHAR(40),
                    ORG_IS_ACTIVE_FLG BOOLEAN,
                    REC_START_TS TIMESTAMP_LTZ,
                    REC_END_TS TIMESTAMP_LTZ,
                    REC_CLOSE_FLG BOOLEAN
                    )
2024-05-06T09:12:02.406849+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.407970+0545 - [Info]: Updating and Inserting Target Table: DWH_ORG_LOC_LU under SCD Type-1 Approach
2024-05-06T09:12:02.407970+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.951301+0545 - [Error]: Query could not be executed with error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [3, 1, 1, "Canada Org", 1, 1714621944440000000, 7258147199999999000, 0]
2024-05-06T09:12:02.952187+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:02.952187+0545 - [Info]: Closing Inactives of: DWH_ORG_LOC_LU under SCD Type-1 Approach
2024-05-06T09:12:02.952187+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:03.171425+0545 - [Info]: Query has been executed successfully: 
            UPDATE DWH_ORG_LOC_LU
            SET REC_CLOSE_FLG = TRUE,
            REC_END_TS = CURRENT_TIMESTAMP
            WHERE ORG_ID NOT IN
            (SELECT DISTINCT ORG_ID FROM TEMP_ORG_LOC_LU)
            
2024-05-06T09:12:03.171425+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:03.172424+0545 - [Info]: ETL of Table: DWH_ORG_LOC_LU  has been completed successfully!!!
2024-05-06T09:12:03.172424+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2024-05-06T09:12:03.381689+0545 - [Info]: Connection has been closed successfully
2024-05-06T09:12:03.382400+0545 - ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
